<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Sub√≠ tu foto</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#000;
  color:#fff;
  font-family:system-ui;
}

form{
  width:90%;
  max-width:420px;
  display:flex;
  flex-direction:column;
  gap:14px;
}

input,button{
  padding:14px;
  font-size:18px;
  border-radius:10px;
  border:none;
}

button{
  background:#00c2ff;
  font-weight:700;
}
</style>
</head>

<body>

<form id="f">
  <input id="nombre" placeholder="Tu nombre" required>
  <input id="mensaje" placeholder="Mensaje (opcional)">
  <input id="foto" type="file" accept="image/*" required>
  <button type="submit">Subir foto üì∏</button>
</form>

<script>
const CLOUD = "craneosuy";
const PRESET = "evento_unsigned";

const f = document.getElementById("f");
const nombre = document.getElementById("nombre");
const mensaje = document.getElementById("mensaje");
const foto = document.getElementById("foto");

f.onsubmit = async e => {
  e.preventDefault();

  if(!foto.files.length){
    alert("Seleccion√° una foto");
    return;
  }

  const n = nombre.value
    .trim()
    .replace(/\s+/g,"_")
    .replace(/[^\w\-]/g,"");

  const m = mensaje.value
    .trim()
    .replace(/\s+/g,"_")
    .replace(/[^\w\-]/g,"");

  const fd = new FormData();
  fd.append("file", foto.files[0]);
  fd.append("upload_preset", PRESET);
  fd.append("tags", "evento"); // üî• CLAVE PARA EL CARRUSEL
  fd.append("public_id", `evento___${n}___${m}`);

  try{
    const r = await fetch(
      `https://api.cloudinary.com/v1_1/${CLOUD}/image/upload`,
      { method:"POST", body: fd }
    );

    if(!r.ok) throw new Error();

    alert("‚úÖ Foto enviada");
    f.reset();
  }catch{
    alert("‚ùå Error al subir la foto");
  }
};
</script>

</body>
</html>
