<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>CRANEOSUY ¬∑ Pantalla del Evento</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: black;
  color: white;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  overflow: hidden;
}

/* ===== LOGO ===== */
#branding {
  position: absolute;
  top: 30px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10;
  transition: all .8s ease;
}

#branding img {
  width: 420px;
  max-width: 70vw;
}

#branding.mini img {
  width: 160px;
}

/* ===== PANTALLA INICIAL ===== */
#inicio {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 26px;
  text-align: center;
  z-index: 5;
}

#inicio img {
  width: 320px;
  background: white;
  padding: 18px;
  border-radius: 22px;
  animation: pulse 2.5s infinite;
}

@keyframes pulse {
  0%   { transform: scale(1); }
  50%  { transform: scale(1.05); }
  100% { transform: scale(1); }
}

#inicio p {
  font-size: 22px;
  opacity: .9;
}

/* ===== ESCENARIO ===== */
#escenario {
  position: absolute;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1;
}

.slide {
  max-width: 90vw;
  max-height: 85vh;
  object-fit: contain;
  opacity: 0;
  transition: opacity 1.2s ease;
}

.slide.activa {
  opacity: 1;
}

/* ===== QR MINI ===== */
#qr-mini {
  position: absolute;
  bottom: 22px;
  right: 22px;
  width: 120px;
  background: white;
  padding: 10px;
  border-radius: 14px;
  display: none;
  z-index: 9;
}

/* ===== TEXTO ===== */
#texto {
  position: absolute;
  bottom: 90px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,.6);
  padding: 14px 22px;
  border-radius: 16px;
  font-size: 22px;
  display: none;
  text-align: center;
  z-index: 8;
}
</style>
</head>

<body>

<!-- LOGO -->
<div id="branding">
  <img src="logo.png" alt="CRANEOSUY">
</div>

<!-- INICIO -->
<div id="inicio">
  <img src="https://api.qrserver.com/v1/create-qr-code/?size=500x500&data=https://mynmzhtz5h-svg.github.io/subida-fotos-evento/">
  <p>Escane√° el QR y sub√≠ tu foto</p>
</div>

<!-- QR CHICO -->
<img
  id="qr-mini"
  src="https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=https://mynmzhtz5h-svg.github.io/subida-fotos-evento/"
>

<!-- TEXTO -->
<div id="texto"></div>

<!-- ESCENARIO -->
<div id="escenario"></div>

<script>
/* ==================================================
   CONFIGURACI√ìN
   üëâ AC√Å SOLO CAMBI√ÅS LA URL DE LAS FOTOS
================================================== */
const URL_FOTOS = "https://mynmzhtz5h-svg.github.io/pantalla-evento/fotos.json";
const INTERVALO = 6000;

/* ==================================================
   ESTADO
================================================== */
let fotos = [];
let indice = 0;

/* ==================================================
   FUNCIONES
================================================== */
async function cargarFotos() {
  const res = await fetch(URL_FOTOS + "?t=" + Date.now());
  if (!res.ok) throw new Error("No se pudieron cargar las fotos");
  return res.json();
}

function mostrarFoto(f) {
  const escenario = document.getElementById("escenario");
  escenario.innerHTML = "";

  const img = document.createElement("img");
  img.src = f.secure_url || f.url;
  img.className = "slide";

  escenario.appendChild(img);
  setTimeout(() => img.classList.add("activa"), 50);

  // Texto opcional desde public_id
  if (f.public_id && f.public_id.includes("___")) {
    const partes = f.public_id.split("___");
    const nombre = partes[0].replace(/_/g, " ");
    const mensaje = partes[1]?.replace(/_/g, " ");

    const texto = document.getElementById("texto");
    texto.innerHTML = `<strong>${nombre}</strong><br>${mensaje}`;
    texto.style.display = "block";
  }
}

async function loop() {
  try {
    fotos = await cargarFotos();
    if (!fotos.length) return;

    // Transici√≥n visual (solo una vez)
    document.getElementById("inicio").style.display = "none";
    document.getElementById("qr-mini").style.display = "block";
    document.getElementById("branding").classList.add("mini");

    mostrarFoto(fotos[indice]);
    indice = (indice + 1) % fotos.length;

  } catch (e) {
    console.error("Error cargando fotos", e);
  }

  setTimeout(loop, INTERVALO);
}

loop();
</script>

</body>
</html>
