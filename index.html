<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Pantalla Evento</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
  margin:0;height:100%;
  background:#000;
  font-family:system-ui;
  overflow:hidden;
}
#carousel{
  width:100%;
  height:100%;
  display:flex;
  justify-content:center;
  align-items:center;
}
img{
  max-width:95%;
  max-height:95%;
  border-radius:20px;
  box-shadow:0 20px 60px rgba(0,0,0,.6);
}
#autor{
  position:absolute;
  bottom:30px;
  left:30px;
  color:#fff;
}
</style>
</head>

<body>

<div id="carousel"></div>
<div id="autor">
  <div id="nombre"></div>
  <div id="mensaje"></div>
</div>

<script>
const WORKER = "https://evento-foto.pablo.workers.dev";

let fotos = [];
let i = 0;

async function cargar(){
  const r = await fetch(WORKER + "/list?ts=" + Date.now());
  fotos = await r.json();
}

function mostrar(){
  if(!fotos.length) return;

  const f = fotos[i];
  carousel.innerHTML = `<img src="${f.url}">`;

  const p = f.public_id.split("___");
  nombre.textContent = p[1]?.replace(/_/g," ") || "";
  mensaje.textContent = p[2]?.replace(/_/g," ") || "";

  i = (i + 1) % fotos.length;
}

setInterval(cargar, 2000);
setInterval(mostrar, 4000);

cargar().then(mostrar);
</script>

</body>
</html>
