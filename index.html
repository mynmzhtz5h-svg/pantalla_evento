<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Pantalla Evento</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
  margin:0;height:100%;
  background:radial-gradient(circle,#222,#000);
  font-family:system-ui;
  overflow:hidden;
}

#branding{
  position:absolute;top:20px;left:50%;
  transform:translateX(-50%);
  z-index:10
}
#branding img{width:200px}

#carousel{
  position:absolute;
  top:160px;
  left:50%;
  transform:translateX(-50%);
  width:90%;
  height:65vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.slide{
  position:absolute;
  max-width:100%;
  max-height:100%;
  opacity:0;
  transition:opacity 1s;
  border-radius:20px;
  box-shadow:0 20px 60px rgba(0,0,0,.6);
}
.slide.activa{opacity:1}

#qr{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  text-align:center;
  transition:all .6s;
}

#qr.chico{
  left:auto;
  right:30px;
  top:50%;
  transform:translateY(-50%);
  width:140px;
}

#qr img{width:60%;border-radius:20px}

#qr div{
  margin-top:12px;
  color:#fff;
  font-size:20px;
  font-weight:600;
}

#autor{
  position:absolute;
  bottom:40px;
  left:30px;
  color:#fff;
  display:none;
}
#autor span{display:block;font-size:20px}
</style>
</head>

<body>

<div id="branding">
  <img src="logo.png">
</div>

<div id="carousel"></div>

<div id="qr">
  <img src="qr.png">
  <div>EscaneÃ¡ y subÃ­ tu foto ðŸ“¸</div>
</div>

<div id="autor">
  <span id="nombre"></span>
  <span id="mensaje"></span>
</div>

<script>
const TAG = "evento"; // el tag que usÃ¡s al subir
const CLOUD = "craneosuy";

const carousel = document.getElementById("carousel");
const qr = document.getElementById("qr");
const autor = document.getElementById("autor");
const nombre = document.getElementById("nombre");
const mensaje = document.getElementById("mensaje");

let fotos = [];
let index = 0;

function cloudinaryCallback(data){
  fotos = data.resources || [];
}

function cargarFotos(){
  const s = document.createElement("script");
  s.src = `https://res.cloudinary.com/${CLOUD}/image/list/${TAG}.json?cb=${Date.now()}`;
  document.body.appendChild(s);
  s.onload = () => s.remove();
}

function mostrar(){
  if(!fotos.length){
    carousel.innerHTML = "";
    autor.style.display = "none";
    qr.classList.remove("chico");
    return;
  }

  qr.classList.add("chico");
  carousel.innerHTML = "";

  const f = fotos[index];
  const img = document.createElement("img");
  img.src = f.secure_url;
  img.className = "slide activa";
  carousel.appendChild(img);

  const partes = f.public_id.split("___");
  nombre.textContent = partes[1]?.replace(/_/g," ") || "";
  mensaje.textContent = partes[2]?.replace(/_/g," ") || "";
  autor.style.display = "block";

  index = (index + 1) % fotos.length;
}

// refresca lista constantemente (foto nueva entra sola)
setInterval(cargarFotos, 2000);

// carrusel
setInterval(mostrar, 4000);

// inicio
cargarFotos();
setTimeout(mostrar, 1500);
</script>
</body>
</html>
